# PostgreSQL configuration for tests
# Use environment variables if set (for docker-compose), otherwise default to localhost
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/extract}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:extractuser}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:demopassword}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.show-sql=false
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.id.new_generator_mappings=true

# Do not start batch job execution as soon as the application is started, use scheduler instead
spring.batch.job.enabled=false
spring.batch.jdbc.initialize-schema=never

# Maximum size of uploaded files
spring.servlet.multipart.max-file-size = 1024MB
spring.servlet.multipart.max-request-size = 1024MB

# Test encryption secrets (not used in production)
database.encryption.secret=test-secret-32-characters-long
database.encryption.salt=test-salt-32-characters-long!!

# LDAP configuration for tests
ldap.url=${LDAP_URL:ldap://localhost:389}
ldap.base.dn=dc=extract,dc=org
ldap.bind.user=cn=admin,dc=extract,dc=org
ldap.bind.password=monsecretadmin
ldap.attributes.login=sAMAccountName
ldap.attributes.mail=mail
ldap.attributes.fullname=cn
ldap.user.objectclass=person

# Use test logging configuration (console only)
logging.config=classpath:logback-test-spring.xml

# Email plugin debug logging
logging.level.ch.asit_asso.extract.plugins.email=DEBUG
logging.level.ch.asit_asso.extract.email=DEBUG

# Disable file logging in tests
logging.level.root=WARN
logging.level.ch.asit_asso.extract=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN

# i18n configuration
extract.i18n.language=de,fr,en

# Thymeleaf configuration
spring.thymeleaf.cache=false
spring.thymeleaf.enabled=true
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.mode=HTML
spring.thymeleaf.prefix=classpath:/templates/pages/
spring.thymeleaf.suffix=.html
spring.thymeleaf.template-resolver-order=1

# Email templates configuration
email.templates.cache=false
email.templates.path=classpath:/templates/email/
email.templates.encoding=UTF-8

# Application external URL for tests
application.external.url=http://localhost:8080/extract/

# Table page size
table.page.size=10

# Allow bean definition overriding in tests
spring.main.allow-bean-definition-overriding=true

appplication.features.perRequestOwnership=false