<!-- de: German -->
<div>
    <h3>Python-Plugin für Extract</h3>

    <p>Dieses Plugin ermöglicht das Ausführen benutzerdefinierter Python-Skripte im Rahmen eines Extract-Prozesses.
        Die Anfrageparameter werden über eine JSON-Datei an das Skript übergeben.</p>

    <h4>Erforderliche Parameter:</h4>
    <ul>
        <li><b>Python-Interpreter:</b> Der vollständige Pfad zur ausführbaren Python-Datei (z. B. /usr/bin/python3, C:\Python39\python.exe)</li>
        <li><b>Python-Skript:</b> Der vollständige Pfad zum auszuführenden Python-Skript</li>
    </ul>

    <h4>Optionale Parameter:</h4>
    <ul>
        <li><b>Zusätzliche Argumente:</b> Weitere Argumente, die an das Python-Skript übergeben werden</li>
    </ul>

    <h4>Ablauf:</h4>
    <ol>
        <li>Das Plugin erstellt im Ausgabeverzeichnis eine Datei <code>parameters.json</code>, die alle Informationen der Anfrage enthält</li>
        <li>Das Python-Skript wird mit dem Pfad zur JSON-Datei als erstem Argument ausgeführt</li>
        <li>Das Skript muss seine Ergebnisse im angegebenen Ausgabeverzeichnis (<code>folderOut</code>) speichern</li>
        <li>Das Skript muss bei Erfolg 0 zurückgeben; jeder andere Wert signalisiert einen Fehler</li>
    </ol>

    <h4>Struktur der Datei parameters.json:</h4>
    <pre>{
    "requestId": "ID der Anfrage",
    "folderOut": "Ausgabeverzeichnis",
    "folderIn": "Eingabeverzeichnis",
    "order": {
        "guid": "GUID des Auftrags",
        "label": "Bezeichnung des Auftrags"
    },
    "client": {
        "guid": "GUID des Kunden",
        "details": "Kundendetails"
    },
    "organism": {
        "guid": "GUID der Organisation",
        "details": "Details zur Organisation"
    },
    "productGuid": "GUID des Produkts",
    "productLabel": "Produktbezeichnung",
    "parameters": {
        // Anfragespezifische Parameter
    },
    "perimeter": {
        // Geometrie im GeoJSON-Format
    }
}</pre>

    <h4>Beispiel für ein Python-Skript:</h4>
    <pre>#!/usr/bin/env python3
import json
import sys
import os

def main():
    if len(sys.argv) < 2:
        print("Fehler: Pfad zur Datei parameters.json erforderlich")
        return 1

    # Parameter laden
    with open(sys.argv[1], 'r') as f:
        params = json.load(f)

    # Ausgabeverzeichnis ermitteln
    output_dir = params['folderOut']

    # Anfrage verarbeiten
    # ... Ihr Code hier ...

    # Ergebnisse speichern
    result_file = os.path.join(output_dir, 'result.txt')
    with open(result_file, 'w') as f:
        f.write("Verarbeitung erfolgreich abgeschlossen")

    return 0

if __name__ == '__main__':
    sys.exit(main())
</pre>

    <h4>Wichtige Hinweise:</h4>
    <ul>
        <li>Das Python-Skript muss ausführbar sein und die entsprechenden Berechtigungen besitzen</li>
        <li>Der Python-Interpreter muss auf dem Extract-Server installiert sein</li>
        <li>Erforderliche Python-Abhängigkeiten müssen installiert sein</li>
        <li>Das Skript wird im Kontext des Ausgabeverzeichnisses ausgeführt</li>
    </ul>
</div>
